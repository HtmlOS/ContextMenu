/*!
 * @htmlos/contextmenu.js v0.1.26
 * (c) 2018-2024 Mr.Fan
 * https://github.com/HtmlOS/contextmenu
 * Released under the MIT License.
 */
function t(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}"function"==typeof SuppressedError&&SuppressedError;var e=function(){function t(){}return t.isDivider=function(t){return!t||!this.hasArrow(t)&&!(t.name&&t.name.trim().length>0)},t.isEnabled=function(t){return!0!==t.disabled},t.hasArrow=function(t){return!!t&&!!(t.children&&t.children.length>0)},t}(),n=function(){function t(t,e,n,i){this.l=t,this.t=e,this.r=t+n,this.b=e+i,this.w=n,this.h=i}return t.prototype.equals=function(t){return null!=t&&null!==t&&this.l===t.l&&this.t===t.t&&this.r===t.r&&this.b===t.b&&this.w===t.w&&this.h===t.h},t.prototype.assign=function(t){t&&(this.l=t.l,this.t=t.t,this.r=t.r,this.b=t.b,this.w=t.w,this.h=t.h)},t}(),i=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.equals=function(t){return null!=t&&null!==t&&this.x===t.x&&this.y===t.y},t}(),o=function(){function t(t){this.element=t}return t.prototype.getBoundingClientRect=function(){if(this.element){var t=this.element.getBoundingClientRect(),e=t.top-document.documentElement.clientTop,i=t.left-document.documentElement.clientLeft;return new n(i,e,t.right-i,t.bottom-e)}},t}(),r=function(){function t(){}return t.preventEvent=function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1},t.getCurrentScrollTop=function(){var t=0;return document.documentElement&&document.documentElement.scrollTop?t=document.documentElement.scrollTop:document.body&&(t=document.body.scrollTop),t},t.getCurrentScrollLeft=function(){var t=0;return document.documentElement&&document.documentElement.scrollLeft?t=document.documentElement.scrollLeft:document.body&&(t=document.body.scrollLeft),t},t.getMouseEventPoint=function(e){var n=t.getCurrentScrollLeft(),o=t.getCurrentScrollTop(),r=e.clientX||e.pageX-n,s=e.clientY||e.pageY-o;return new i(r,s)},t.getClientRect=function(t){t=t||0;var e=0,i=0;return window.innerWidth?e=window.innerWidth:document.body&&document.body.clientWidth&&(e=document.body.clientWidth),window.innerHeight?i=window.innerHeight:document.body&&document.body.clientHeight&&(i=document.body.clientHeight),document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth&&(i=document.documentElement.clientHeight,e=document.documentElement.clientWidth),new n(t,t,e-2*t,i-2*t)},t.visitElemementChildren=function(t,e){for(var n=t.firstChild,i=0;null!=n;)1===n.nodeType&&e(i++,new o(n)),n=n.nextSibling},t.runOnCondition=function(e,n,i,o){i()||setTimeout((function(){if(!i())if(n())try{e()}catch(t){return}else t.runOnCondition(e,n,i,o)}),o)},t}(),s={debuggable:!1,debug:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];window.console&&s.debuggable&&console.log.apply(console,[t,e])},error:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];window.console&&console.error.apply(console,[t,e])}},u=function(){function e(){this._keys=[],this._values=[]}return e.prototype.size=function(){return this._keys.length},e.prototype.indexOfKey=function(t){for(var e in this._keys){if(this._keys[e]===t)return parseInt(e,10)}return-1},e.prototype.has=function(t){return this.containsKey(t)},e.prototype.containsKey=function(e){var n,i;try{for(var o=t(this._keys),r=o.next();!r.done;r=o.next()){if(r.value===e)return!0}}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1},e.prototype.containsValue=function(e){var n,i;try{for(var o=t(this._values),r=o.next();!r.done;r=o.next()){if(r.value===e)return!0}}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1},e.prototype.set=function(t,e){this.put(t,e)},e.prototype.put=function(t,e){this.delete(t),this._keys.push(t),this._values.push(e)},e.prototype.get=function(t){var e=this.indexOfKey(t);return-1===e?void 0:this._values[e]},e.prototype.keys=function(){return this._keys.concat()},e.prototype.values=function(){return this._values.concat()},e.prototype.remove=function(t){return this.delete(t)},e.prototype.delete=function(t){var e=this.indexOfKey(t);if(-1!==e){this._keys.splice(e,1);var n=this._values.splice(e,1);return n.length>0?n[0]:void 0}},e.prototype.clear=function(){this._keys.splice(0,this._keys.length),this._values.splice(0,this._values.length)},e.prototype.forEach=function(t){var e=this.keys(),n=this.values();for(var i in e){var o=e[i];t(n[i],o)}},e}(),c=function(e){var n,i,o,r,s=e.style;this.contextmenu=(null==s?void 0:s.contextmenu)||"contextmenu";var u={name:"contextmenu-in",time:0},c={name:"contextmenu-out",time:0};if(null==s?void 0:s.contextmenuIn)try{for(var l=t(s.contextmenuIn),a=l.next();!a.done;a=l.next())"number"==typeof(m=a.value)?u.time=m:"string"==typeof m&&(u.name=m)}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(null==s?void 0:s.contextmenuOut)try{for(var h=t(s.contextmenuOut),d=h.next();!d.done;d=h.next()){var m;"number"==typeof(m=d.value)?c.time=m:"string"==typeof m&&(c.name=m)}}catch(t){o={error:t}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(o)throw o.error}}this.contextmenuIn=[u.name,u.time],this.contextmenuOut=[c.name,c.time],this.contextmenuDivider=(null==s?void 0:s.contextmenuDivider)||"contextmenu-divider",this.contextmenuItem=(null==s?void 0:s.contextmenuItem)||"contextmenu-item",this.contextmenuItemSelected=(null==s?void 0:s.contextmenuItemSelected)||"contextmenu-item-selected",this.contextmenuItemDisabled=(null==s?void 0:s.contextmenuItemDisabled)||"contextmenu-item-disabled",this.contextmenuItemIcon=(null==s?void 0:s.contextmenuItemIcon)||"contextmenu-item-icon",this.contextmenuItemName=(null==s?void 0:s.contextmenuItemName)||"contextmenu-item-name",this.contextmenuItemHotkey=(null==s?void 0:s.contextmenuItemHotkey)||"contextmenu-item-hotkey",this.contextmenuItemArrow=(null==s?void 0:s.contextmenuItemArrow)||"contextmenu-item-arrow"},l=function(){function t(t,e,i){this.rootViewRect=new n(0,0,0,0),this.itemViewRect=new n(0,0,0,0),this.itemViewRects=new u,this.id=t,this.items=e,this.options=i,this.style=new c(i),this.rootView=this.generateMenuView(),this.select(-1)}return Object.defineProperty(t.prototype,"onStateChangedListener",{get:function(){return this.onStateChangedListening},set:function(t){this.onStateChangedListening=t,this.updateStateChangedListener()},enumerable:!1,configurable:!0}),t.prototype.select=function(t){var e=this;this.visitItems((function(n,i,o){e.updateItemViewClass(o,i,n===t)}))},t.prototype.hide=function(){var t=this.rootView,e=this.options.layer||t.parentElement;e&&("visible"===t.style.visibility?(t.className=[this.style.contextmenu,this.style.contextmenuOut[0]].join(" "),setTimeout((function(){e.removeChild(t)}),this.style.contextmenuOut[1]||0)):e.removeChild(t))},t.prototype.show=function(t){var e=this,i=this.rootView;i.className=this.style.contextmenu,i.style.visibility="hidden";var u=this.fixedLocation(t);i.style.top=u.t+"px",i.style.left=u.l+"px",s.debug("menu view render start : anchor rect =",t);var c=(new Date).getTime();void 0!==this.onStateChangedListener&&this.onStateChangedListener.onRenderStart();var l=this.options.layer||i.parentElement;l&&(l.appendChild(i),r.runOnCondition((function(){var u=i.offsetWidth,a=i.offsetHeight;s.debug("menu view init size: ",u+"x"+a),e.rootViewRect.assign(new n(0,0,u,a)),e.computeItemRects();var h=u-e.itemViewRect.w,d=a-e.itemViewRect.h;s.debug("menu view padding: ",h,d);var m=e.fixedLocation(t);e.rootViewRect.assign(m),s.debug("menu view fixed: ",e.rootViewRect.w+"x"+e.rootViewRect.h,e.rootViewRect);var y=m.w-h,f=m.h-d;i.style.width=y+"px",i.style.height=f+"px",i.style.top=m.t+"px",i.style.left=m.l+"px",r.runOnCondition((function(){i.style.visibility="visible",i.className=[e.style.contextmenu,e.style.contextmenuIn[0]].join(" "),e.computeItemRects();var t=(new Date).getTime()-c;s.debug("menu view render end : cost "+t+"ms"),void 0!==e.onStateChangedListener&&e.onStateChangedListener.onRenderStop(t)}),(function(){var t=new o(i).getBoundingClientRect();return null!=t&&Math.abs(t.l-e.rootViewRect.l)<1&&Math.abs(t.t-e.rootViewRect.t)<1}),(function(){return!l.contains(i)}),10)}),(function(){return void 0!==i.offsetWidth&&i.offsetWidth>=0&&void 0!==i.offsetHeight&&i.offsetHeight>0}),(function(){return!l.contains(i)}),10))},t.prototype.updateStateChangedListener=function(){var t=this;this.visitItems((function(n,i,o){var s;void 0===t.onStateChangedListener||e.isDivider(o)||(i.element.onmouseover=function(t,e){return function(){e(t)}}(n,t.onStateChangedListener.onSelected),i.element.onmouseleave=(s=t.onStateChangedListener.onSelected,function(){s(-1)}),i.element.onclick=function(t,e,n){return function(i){r.preventEvent(i),n(t,e)}}(n,o,t.onStateChangedListener.onClicked))}))},t.prototype.generateMenuView=function(){var t=document.createElement("table");for(var e in t.id=this.id,t.setAttribute("border","0"),t.setAttribute("cellspacing","0"),t.setAttribute("cellpadding","0"),t.style.margin="0px",t.style.position="fixed",t.style.width="auto",t.style.height="auto",t.style.zIndex="2147483647",t.style.top="0px",t.style.left="0px",this.items){var n=this.items[e],i=this.generateItemView(n);t.appendChild(i)}return t},t.prototype.generateItemView=function(t){var n=document.createElement("tr"),i=e.hasArrow(t),o=void 0!==t.hotkey&&t.hotkey.length>0,r=t.icon||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",s=this.options.i18n(t.name||"")||t.name||"",u=t.hotkey||"";if(e.isDivider(t)){var c=document.createElement("th");c.setAttribute("align","center"),c.setAttribute("colspan","4"),c.appendChild(document.createElement("hr")),n.appendChild(c)}else{var l=document.createElement("td"),a=document.createElement("td"),h=document.createElement("td"),d=document.createElement("td");n.appendChild(l),n.appendChild(a),n.appendChild(h),n.appendChild(d),l.innerHTML='\n                <img class="'.concat(this.style.contextmenuItemIcon,'" src="').concat(r,'" draggable="false"/>\n            '),a.innerHTML='\n                <div class="'.concat(this.style.contextmenuItemName,'">').concat(s,"</div>\n            "),h.innerHTML='\n                <div class="'.concat(this.style.contextmenuItemHotkey,'"\n                    style="display:').concat(o?"block":"none",'">\n                    ').concat(u,"\n                </div>\n            "),d.innerHTML='\n                <div class="'.concat(this.style.contextmenuItemArrow,'"\n                    style="display:').concat(i?"block":"none",'"></div>\n                <div class="').concat(this.style.contextmenuItemArrow,'"\n                    style="display:').concat(i?"none":"block",'; visibility: hidden"></div>\n            ')}return n},t.prototype.updateItemViewClass=function(t,n,i){e.isDivider(t)?n.element.className=this.style.contextmenuDivider:e.isEnabled(t)?n.element.className=i?[this.style.contextmenuItem,this.style.contextmenuItemSelected].join(" "):this.style.contextmenuItem:n.element.className=[this.style.contextmenuItem,this.style.contextmenuItemDisabled].join(" ")},t.prototype.computeItemRects=function(){var t=this,i=0;r.visitElemementChildren(this.rootView,(function(o,r){var s=r.getBoundingClientRect();if(s){var u=t.items[o];if(!e.isDivider(u)){var c=s.l,l=s.t,a=s.w,h=s.h;t.itemViewRects.set(i++,new n(c,l,a,h))}0===o&&(t.itemViewRect.t=s.t,t.itemViewRect.l=s.l,t.itemViewRect.r=s.r),t.itemViewRect.b=s.b,t.itemViewRect.w=t.itemViewRect.r-t.itemViewRect.l,t.itemViewRect.h=t.itemViewRect.b-t.itemViewRect.t}}))},t.prototype.visitItems=function(t){var n=this,i=0;r.visitElemementChildren(this.rootView,(function(o,r){var s=n.items[o];e.isDivider(s)?t(-1,r,s):t(i++,r,s)}))},t.prototype.fixedLocation=function(t){var e=r.getClientRect(4);s.debug("menu view fix location: screen rect = ",e);var i,o,u,c,l,a,h=this.rootViewRect.w,d=this.rootViewRect.h,m=t.l,y=t.t,f=t.r,p=t.b,v=e.h,g=e.l,w=e.t,x=e.r,b=e.b,I=m-g,C=x-f,k=p-w,S=b-y;switch(i=C>=h?"right":I>=h?"left":C>=I?"right":"left",o=S>=d?"down":k>=d?"up":S>=k?"bottom":"top",s.debug("menu view dock @",i,o),i){case"left":u=m-(l=h);break;case"right":l=h,u=f}switch(o){case"up":c=p-(a=d);break;case"down":a=d,c=y;break;case"top":a=Math.min(d,v),c=w;break;case"bottom":c=b-(a=Math.min(d,v))}return new n(u,c,l,a)},t}(),a=function(){function t(e){t.assgin(this,{layer:document.body,i18n:function(t){return t}}),t.assgin(this,e)}return t.assgin=function(t,e){e&&t&&(t.layer=e.layer||t.layer,t.i18n=e.i18n||t.i18n,e.style&&(t.style?(t.style.contextmenu=e.style.contextmenu||t.style.contextmenu,t.style.contextmenuIn=e.style.contextmenuIn||t.style.contextmenuIn,t.style.contextmenuOut=e.style.contextmenuOut||t.style.contextmenuOut,t.style.contextmenuDivider=e.style.contextmenuDivider||t.style.contextmenuDivider,t.style.contextmenuItem=e.style.contextmenuItem||t.style.contextmenuItem,t.style.contextmenuItemSelected=e.style.contextmenuItemSelected||t.style.contextmenuItemSelected,t.style.contextmenuItemDisabled=e.style.contextmenuItemDisabled||t.style.contextmenuItemDisabled,t.style.contextmenuItemIcon=e.style.contextmenuItemIcon||t.style.contextmenuItemIcon,t.style.contextmenuItemName=e.style.contextmenuItemName||t.style.contextmenuItemName,t.style.contextmenuItemHotkey=e.style.contextmenuItemHotkey||t.style.contextmenuItemHotkey,t.style.contextmenuItemArrow=e.style.contextmenuItemArrow||t.style.contextmenuItemArrow):t.style=e.style))},t}(),h=function(){function i(t,e,n){this.id=(new Date).toUTCString(),this.menuStacks=new u,this.event=t,this.menuItems=e,this.menuPosition=t.getPoint(),this.menuOptions=n||new a}return i.prototype.getMenuItemsById=function(n){var i,o,r,s;if(!n||"0"===n)return this.menuItems;if(0===n.indexOf("0")){var u=n.split(",");u.shift();var c=this.menuItems;try{for(var l=t(u),a=l.next();!a.done;a=l.next()){var h=a.value,d=0;try{for(var m=(r=void 0,t(c)),y=m.next();!y.done;y=m.next()){var f=y.value;if(!e.isDivider(f)&&parseInt(h,10)===d++){var p=null==f?void 0:f.children;if(null==p)return;c=p}}}catch(t){r={error:t}}finally{try{y&&!y.done&&(s=m.return)&&s.call(m)}finally{if(r)throw r.error}}}}catch(t){i={error:t}}finally{try{a&&!a.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return c}},i.prototype.hideMenu=function(t){t||(t="0"),this.hideMenuStack(t)},i.prototype.showMenu=function(e){var n,i;e||(e="0");for(var o=new u,r=e.split(",");r.length>0;){var c=r.join(",");o.set(c,""),r.pop()}var l=o.keys(),a=this.menuStacks.keys();try{for(var h=t(a),d=h.next();!d.done;d=h.next()){var m=d.value;o.has(m)||(s.debug("menu remove by id",m),this.hideMenuStack(m))}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}this.showMenuStack(l)},i.prototype.hideMenuStack=function(t){var e=this;this.menuStacks.forEach((function(n,i){i.indexOf(t)>=0&&(n.hide(),e.menuStacks.delete(i))}))},i.prototype.showMenuStack=function(e){var i,o,u=this;e.sort(),s.debug("menu show stacks :",e);var c=this.menuStacks,a=function(t){var i=t.indexOf(",")>=0,o=parseInt(i?t.substr(t.lastIndexOf(",")+1):t,10),a=i?t.substr(0,t.lastIndexOf(",")):void 0,d=void 0===a?void 0:c.get(a);void 0!==d&&d.select(o);var m=c.get(t);if(void 0!==m)return m.select(-1),"continue";var y=h.getMenuItemsById(t);if(!y)return s.debug("menu show stacks : no items "),{value:void 0};var f=new l(t,y,h.menuOptions);f.onStateChangedListener={onSelected:function(e){-1===e?u.postSelection("o",t):u.postSelection("i",t+","+e)},onClicked:function(t,e){u.onItemClick&&u.onItemClick(t,e)},onRenderStart:function(){},onRenderStop:function(){u.showMenuStack(e)}},f.rootView.oncontextmenu=function(t){r.preventEvent(t)},f.rootView.onmouseenter=function(){u.postSelection("i",t)},f.rootView.onmouseleave=function(){u.postSelection("o","0")};var p=void 0===d?new n(h.menuPosition.x,h.menuPosition.y,0,0):d.itemViewRects.get(o);p&&h.isAlive()&&(s.debug("menu show stack :",t),f.show(p),h.menuStacks.set(t,f))},h=this;try{for(var d=t(e),m=d.next();!m.done;m=d.next()){var y=a(m.value);if("object"==typeof y)return y.value}}catch(t){i={error:t}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}},i.prototype.postSelection=function(t,e){var n=this;"i"===t&&this.postSelectionType===t&&this.postSelectionId.indexOf(e)>=0||(s.debug("menu post stacks : id =",e),clearTimeout(this.postSelectionTimerId),this.postSelectionType=t,this.postSelectionId=e,this.postSelectionTimerId=setTimeout((function(){n.isDestroyed()?s.debug("menu is destroyed"):n.showMenu(e)}),10))},i.prototype.isAlive=function(){return!this.isDestroyed()},i.prototype.isDestroyed=function(){return!0===this.destroyed},i.prototype.postDestroy=function(){var t=this;this.destroyed=!0,clearTimeout(this.postSelectionTimerId),this.hideMenu(),setTimeout((function(){t.menuStacks.size()>0&&t.postDestroy()}),50)},i}(),d=function(){function t(t){this.e=t,this.target=new o((null==t?void 0:t.srcElement)||(null==t?void 0:t.target)),this.button=t.button,this.keyCode=t.keyCode,this.charCode=t.charCode,this.which=t.which,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey}return t.prototype.isKeyboardEvent=function(){return this.e instanceof KeyboardEvent||this.e.keyCode||this.e.charCode||this.e.which},t.prototype.isMouseEvent=function(){return this.e instanceof MouseEvent||this.e.button},t.prototype.getPoint=function(){var t=r.getCurrentScrollLeft(),e=r.getCurrentScrollTop(),n=this.e.clientX||this.e.pageX-t,o=this.e.clientY||this.e.pageY-e;return new i(n,o)},t.prototype.prevent=function(){this.e.preventDefault&&this.e.preventDefault(),this.e.stopPropagation&&this.e.stopPropagation(),this.e.cancelBubble=!0,this.e.returnValue=!1},t}(),m=function(){function e(t){this.listeners=new u,this.menu=t}return e.prototype.stop=function(){this.listeners.forEach((function(t,e){window.removeEventListener(e,t)})),this.listeners.clear()},e.prototype.start=function(e){var n,i,r=this,c=function(e){if(null==e||0===e.trim().length)return s.debug("event not found"),"continue";var n=e.split(":"),i=n[0];n.shift();var c=0===n.length?[]:n,a=function(n){var i,l,a,h;if((n=new d(n)).isMouseEvent()){var m=n.getPoint(),y=(null===(h=null===(a=r.menu)||void 0===a?void 0:a.presenter)||void 0===h?void 0:h.menuStacks)||new u;try{for(var f=(i=void 0,t(y.values())),p=f.next();!p.done;p=f.next()){var v=p.value,g=new o(v.rootView).getBoundingClientRect();if(g&&m.x>=g.l&&m.x<=g.r&&m.y>=g.t&&m.y<=g.b)return}}catch(t){i={error:t}}finally{try{p&&!p.done&&(l=f.return)&&l.call(f)}finally{if(i)throw i.error}}var w=[void 0!==(x=n.button)?""+x:"",n.altKey?"alt":"",n.ctrlKey?"alt":"",n.metaKey?"alt":"",n.shiftKey?"alt":""];if(c.length>0&&!r.containsKey(c,w.join("+")))return;r.onevent(e)}else if(n.isKeyboardEvent()){var x=void 0;void 0!==n.keyCode&&(x=void 0===x?n.keyCode:Math.max(x,n.keyCode)),void 0!==n.charCode&&(x=void 0===x?n.charCode:Math.max(x,n.charCode)),void 0!==n.which&&(x=void 0===x?n.which:Math.max(x,n.which)),16!==x&&17!==x&&18!==x&&224!==x||(x=void 0);w=[void 0!==x?""+x:"",n.altKey?"alt":"",n.ctrlKey?"ctrl":"",n.metaKey?"meta":"",n.shiftKey?"shift":""];r.containsKey(c,w.join("+"))&&r.onevent(e)}else 0===c.length?r.onevent(e):s.error("monitor unsupported event: ",e)};s.debug("monitor add listener: ",e,i,c),window.addEventListener(i,a,!0),l.listeners.set(e,a)},l=this;try{for(var a=t(e),h=a.next();!h.done;h=a.next()){c(h.value)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},e.prototype.equalsKey=function(t,e){var n=function(t){return t=(t=(t=(t=t.replace(/\s+/g,"")).replace(/\++/g,"+")).replace(/^\++/g,"")).replace(/\++$/g,"")};t=n(t),e=n(e);var i=t.split("+"),o=e.split("+");return i.sort(),o.sort(),t=i.join("+"),e=o.join("+"),s.debug("monitor event equals : ",t,e),t===e},e.prototype.containsKey=function(e,n){var i,o;try{for(var r=t(e),s=r.next();!s.done;s=r.next()){var u=s.value;if(this.equalsKey(u,n))return!0}}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return!1},e}(),y=function(){function t(t){this.menu=t}return t.prototype.stop=function(){this.stopped=!0,this.timer&&(clearTimeout(this.timer),this.timer=void 0)},t.prototype.start=function(){this.stop(),this.stopped=!1,this.run()},t.prototype.run=function(){var t=this;this.timer=setTimeout((function(){var e,n,i;if(!0!==t.stopped){var o=null===(n=null===(e=t.menu)||void 0===e?void 0:e.presenter)||void 0===n?void 0:n.event,r=null===(i=null==o?void 0:o.target)||void 0===i?void 0:i.getBoundingClientRect();r&&(void 0===t.targetRect||r.equals(t.targetRect)?t.targetRect=r:t.hide()),t.run()}}),100)},t.prototype.hide=function(){this.targetRect=void 0,this.onchanged&&this.onchanged("other:target moved or resize")},t}(),f=function(){function t(t){this.targetRectListner=new y(t),this.eventsListener=new m(t),this.events=["keydown:27","mousedown","resize"],this.menu=t}return t.prototype.start=function(){var t=this;s.debug("monitor start");var e=function(e){t.menu.presenter&&(s.debug("monitor hidemenu by ",e),t.menu.hide())};this.targetRectListner.onchanged=e,this.targetRectListner.start(),this.eventsListener.onevent=e,this.eventsListener.start(this.events)},t.prototype.stop=function(){this.targetRectListner.stop(),this.eventsListener.stop(),s.debug("monitor stop")},t}(),p=new(function(){function t(){this.options=new a,this.options=new a}return t.prototype.config=function(t){a.assgin(this.options,t)},t.prototype.hide=function(){this.monitor&&this.monitor.stop(),null!=this.presenter&&(s.debug("hide menu"),this.presenter.postDestroy(),this.presenter=void 0)},t.prototype.show=function(t,n){var i=this,o=new d(window.event);if(o.isMouseEvent()){o.prevent(),this.hide(),s.debug("show menu",t,o.getPoint());var r=new a;a.assgin(r,this.options),a.assgin(r,n),this.presenter=new h(o,t,r),this.presenter.onItemClick=function(t,n){e.isEnabled(n)&&n.onclick&&(i.hide(),setTimeout((function(){e.isEnabled(n)&&n.onclick&&n.onclick(t,n)}),10))},this.presenter.showMenu(),this.monitor=new f(this),this.monitor.start()}},t}());window&&Object.defineProperty(window,"ContextMenu",{value:p,writable:!1,configurable:!1}),Object.defineProperty(p,"debug",{value:function(t){s.debuggable=t},writable:!1,configurable:!1});export{p as ContextMenu,a as ContextMenuOptions,p as default};
//# sourceMappingURL=contextmenu.esm.js.map

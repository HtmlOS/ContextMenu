/*!
 * @htmlos/contextmenu.js v0.1.23
 * (c) 2018-2021 Mr.Fan
 * https://github.com/HtmlOS/contextmenu
 * Released under the MIT License.
 */
function e(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var t=function(){function e(){}return e.isDivider=function(e){return!e||!this.hasArrow(e)&&!(e.name&&e.name.trim().length>0)},e.isEnabled=function(e){return!0!==e.disabled},e.hasArrow=function(e){return!!e&&!!(e.children&&e.children.length>0)},e}(),n=function(){function e(e,t,n,i){this.l=e,this.t=t,this.r=e+n,this.b=t+i,this.w=n,this.h=i}return e.prototype.equals=function(e){return null!=e&&null!==e&&this.l===e.l&&this.t===e.t&&this.r===e.r&&this.b===e.b&&this.w===e.w&&this.h===e.h},e.prototype.assign=function(e){e&&(this.l=e.l,this.t=e.t,this.r=e.r,this.b=e.b,this.w=e.w,this.h=e.h)},e}(),i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.equals=function(e){return null!=e&&null!==e&&this.x===e.x&&this.y===e.y},e}(),o=function(){function e(e){this.element=e}return e.prototype.getBoundingClientRect=function(){if(this.element){var e=this.element.getBoundingClientRect(),t=e.top-document.documentElement.clientTop,i=e.left-document.documentElement.clientLeft;return new n(i,t,e.right-i,e.bottom-t)}},e}(),r=function(){function e(){}return e.preventEvent=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1},e.getCurrentScrollTop=function(){var e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},e.getCurrentScrollLeft=function(){var e=0;return document.documentElement&&document.documentElement.scrollLeft?e=document.documentElement.scrollLeft:document.body&&(e=document.body.scrollLeft),e},e.getMouseEventPoint=function(t){var n=e.getCurrentScrollLeft(),o=e.getCurrentScrollTop(),r=t.clientX||t.pageX-n,s=t.clientY||t.pageY-o;return new i(r,s)},e.getClientRect=function(e){e=e||0;var t=0,i=0;return window.innerWidth?t=window.innerWidth:document.body&&document.body.clientWidth&&(t=document.body.clientWidth),window.innerHeight?i=window.innerHeight:document.body&&document.body.clientHeight&&(i=document.body.clientHeight),document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth&&(i=document.documentElement.clientHeight,t=document.documentElement.clientWidth),new n(e,e,t-2*e,i-2*e)},e.visitElemementChildren=function(e,t){for(var n=e.firstChild,i=0;null!=n;)1===n.nodeType&&t(i++,new o(n)),n=n.nextSibling},e.runOnCondition=function(t,n,i,o){i()||setTimeout((function(){if(!i())if(n())try{t()}catch(e){return}else e.runOnCondition(t,n,i,o)}),o)},e}(),s={debuggable:!1,debug:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];window.console&&s.debuggable&&console.log.apply(console,[e,t])},error:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];window.console&&console.error.apply(console,[e,t])}},u=function(){function t(){this._keys=[],this._values=[]}return t.prototype.size=function(){return this._keys.length},t.prototype.indexOfKey=function(e){for(var t in this._keys){if(this._keys[t]===e)return parseInt(t,10)}return-1},t.prototype.has=function(e){return this.containsKey(e)},t.prototype.containsKey=function(t){var n,i;try{for(var o=e(this._keys),r=o.next();!r.done;r=o.next()){if(r.value===t)return!0}}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1},t.prototype.containsValue=function(t){var n,i;try{for(var o=e(this._values),r=o.next();!r.done;r=o.next()){if(r.value===t)return!0}}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1},t.prototype.set=function(e,t){this.put(e,t)},t.prototype.put=function(e,t){this.delete(e),this._keys.push(e),this._values.push(t)},t.prototype.get=function(e){var t=this.indexOfKey(e);return-1===t?void 0:this._values[t]},t.prototype.keys=function(){return this._keys.concat()},t.prototype.values=function(){return this._values.concat()},t.prototype.remove=function(e){return this.delete(e)},t.prototype.delete=function(e){var t=this.indexOfKey(e);if(-1!==t){this._keys.splice(t,1);var n=this._values.splice(t,1);return n.length>0?n[0]:void 0}},t.prototype.clear=function(){this._keys.splice(0,this._keys.length),this._values.splice(0,this._values.length)},t.prototype.forEach=function(e){var t=this.keys(),n=this.values();for(var i in t){var o=t[i];e(n[i],o)}},t}(),c=function(t){var n,i,o,r,s=t.style;this.contextmenu=(null==s?void 0:s.contextmenu)||"contextmenu";var u={name:"contextmenu-in",time:0},c={name:"contextmenu-out",time:0};if(null==s?void 0:s.contextmenuIn)try{for(var l=e(s.contextmenuIn),a=l.next();!a.done;a=l.next())"number"==typeof(m=a.value)?u.time=m:"string"==typeof m&&(u.name=m)}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(null==s?void 0:s.contextmenuOut)try{for(var h=e(s.contextmenuOut),d=h.next();!d.done;d=h.next()){var m;"number"==typeof(m=d.value)?c.time=m:"string"==typeof m&&(c.name=m)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(o)throw o.error}}this.contextmenuIn=[u.name,u.time],this.contextmenuOut=[c.name,c.time],this.contextmenuDivider=(null==s?void 0:s.contextmenuDivider)||"contextmenu-divider",this.contextmenuItem=(null==s?void 0:s.contextmenuItem)||"contextmenu-item",this.contextmenuItemSelected=(null==s?void 0:s.contextmenuItemSelected)||"contextmenu-item-selected",this.contextmenuItemDisabled=(null==s?void 0:s.contextmenuItemDisabled)||"contextmenu-item-disabled",this.contextmenuItemIcon=(null==s?void 0:s.contextmenuItemIcon)||"contextmenu-item-icon",this.contextmenuItemName=(null==s?void 0:s.contextmenuItemName)||"contextmenu-item-name",this.contextmenuItemHotkey=(null==s?void 0:s.contextmenuItemHotkey)||"contextmenu-item-hotkey",this.contextmenuItemArrow=(null==s?void 0:s.contextmenuItemArrow)||"contextmenu-item-arrow"},l=function(){function e(e,t,i){this.rootViewRect=new n(0,0,0,0),this.itemViewRect=new n(0,0,0,0),this.itemViewRects=new u,this.id=e,this.items=t,this.options=i,this.style=new c(i),this.rootView=this.generateMenuView(),this.select(-1)}return Object.defineProperty(e.prototype,"onStateChangedListener",{get:function(){return this.onStateChangedListening},set:function(e){this.onStateChangedListening=e,this.updateStateChangedListener()},enumerable:!1,configurable:!0}),e.prototype.select=function(e){var t=this;this.visitItems((function(n,i,o){t.updateItemViewClass(o,i,n===e)}))},e.prototype.hide=function(){var e=this.rootView,t=this.options.layer||e.parentElement;t&&("visible"===e.style.visibility?(e.className=[this.style.contextmenu,this.style.contextmenuOut[0]].join(" "),setTimeout((function(){t.removeChild(e)}),this.style.contextmenuOut[1]||0)):t.removeChild(e))},e.prototype.show=function(e){var t=this,i=this.rootView;i.className=this.style.contextmenu,i.style.visibility="hidden";var u=this.fixedLocation(e);i.style.top=u.t+"px",i.style.left=u.l+"px",s.debug("menu view render start : anchor rect =",e);var c=(new Date).getTime();void 0!==this.onStateChangedListener&&this.onStateChangedListener.onRenderStart();var l=this.options.layer||i.parentElement;l&&(l.appendChild(i),r.runOnCondition((function(){var u=i.offsetWidth,a=i.offsetHeight;s.debug("menu view init size: ",u+"x"+a),t.rootViewRect.assign(new n(0,0,u,a)),t.computeItemRects();var h=u-t.itemViewRect.w,d=a-t.itemViewRect.h;s.debug("menu view padding: ",h,d);var m=t.fixedLocation(e);t.rootViewRect.assign(m),s.debug("menu view fixed: ",t.rootViewRect.w+"x"+t.rootViewRect.h,t.rootViewRect);var y=m.w-h,f=m.h-d;i.style.width=y+"px",i.style.height=f+"px",i.style.top=m.t+"px",i.style.left=m.l+"px",r.runOnCondition((function(){i.style.visibility="visible",i.className=[t.style.contextmenu,t.style.contextmenuIn[0]].join(" "),t.computeItemRects();var e=(new Date).getTime()-c;s.debug("menu view render end : cost "+e+"ms"),void 0!==t.onStateChangedListener&&t.onStateChangedListener.onRenderStop(e)}),(function(){var e=new o(i).getBoundingClientRect();return null!=e&&Math.abs(e.l-t.rootViewRect.l)<1&&Math.abs(e.t-t.rootViewRect.t)<1}),(function(){return!l.contains(i)}),10)}),(function(){return void 0!==i.offsetWidth&&i.offsetWidth>=0&&void 0!==i.offsetHeight&&i.offsetHeight>0}),(function(){return!l.contains(i)}),10))},e.prototype.updateStateChangedListener=function(){var e=this;this.visitItems((function(n,i,o){var s;void 0===e.onStateChangedListener||t.isDivider(o)||(i.element.onmouseover=function(e,t){return function(){t(e)}}(n,e.onStateChangedListener.onSelected),i.element.onmouseleave=(s=e.onStateChangedListener.onSelected,function(){s(-1)}),i.element.onclick=function(e,t,n){return function(i){r.preventEvent(i),n(e,t)}}(n,o,e.onStateChangedListener.onClicked))}))},e.prototype.generateMenuView=function(){var e=document.createElement("table");for(var t in e.id=this.id,e.setAttribute("border","0"),e.setAttribute("cellspacing","0"),e.setAttribute("cellpadding","0"),e.style.margin="0px",e.style.position="fixed",e.style.width="auto",e.style.height="auto",e.style.zIndex="2147483647",e.style.top="0px",e.style.left="0px",this.items){var n=this.items[t],i=this.generateItemView(n);e.appendChild(i)}return e},e.prototype.generateItemView=function(e){var n=document.createElement("tr"),i=t.hasArrow(e),o=void 0!==e.hotkey&&e.hotkey.length>0,r=e.icon||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",s=this.options.i18n(e.name||"")||e.name||"",u=e.hotkey||"";if(t.isDivider(e)){var c=document.createElement("th");c.setAttribute("align","center"),c.setAttribute("colspan","4"),c.appendChild(document.createElement("hr")),n.appendChild(c)}else{var l=document.createElement("td"),a=document.createElement("td"),h=document.createElement("td"),d=document.createElement("td");n.appendChild(l),n.appendChild(a),n.appendChild(h),n.appendChild(d),l.innerHTML='\n                <img class="'+this.style.contextmenuItemIcon+'" src="'+r+'" draggable="false"/>\n            ',a.innerHTML='\n                <div class="'+this.style.contextmenuItemName+'">'+s+"</div>\n            ",h.innerHTML='\n                <div class="'+this.style.contextmenuItemHotkey+'"\n                    style="display:'+(o?"block":"none")+'">\n                    '+u+"\n                </div>\n            ",d.innerHTML='\n                <div class="'+this.style.contextmenuItemArrow+'"\n                    style="display:'+(i?"block":"none")+'"></div>\n                <div class="'+this.style.contextmenuItemArrow+'"\n                    style="display:'+(i?"none":"block")+'; visibility: hidden"></div>\n            '}return n},e.prototype.updateItemViewClass=function(e,n,i){t.isDivider(e)?n.element.className=this.style.contextmenuDivider:t.isEnabled(e)?n.element.className=i?[this.style.contextmenuItem,this.style.contextmenuItemSelected].join(" "):this.style.contextmenuItem:n.element.className=[this.style.contextmenuItem,this.style.contextmenuItemDisabled].join(" ")},e.prototype.computeItemRects=function(){var e=this,i=0;r.visitElemementChildren(this.rootView,(function(o,r){var s=r.getBoundingClientRect();if(s){var u=e.items[o];if(!t.isDivider(u)){var c=s.l,l=s.t,a=s.w,h=s.h;e.itemViewRects.set(i++,new n(c,l,a,h))}0===o&&(e.itemViewRect.t=s.t,e.itemViewRect.l=s.l,e.itemViewRect.r=s.r),e.itemViewRect.b=s.b,e.itemViewRect.w=e.itemViewRect.r-e.itemViewRect.l,e.itemViewRect.h=e.itemViewRect.b-e.itemViewRect.t}}))},e.prototype.visitItems=function(e){var n=this,i=0;r.visitElemementChildren(this.rootView,(function(o,r){var s=n.items[o];t.isDivider(s)?e(-1,r,s):e(i++,r,s)}))},e.prototype.fixedLocation=function(e){var t=r.getClientRect(4);s.debug("menu view fix location: screen rect = ",t);var i,o,u,c,l,a,h=this.rootViewRect.w,d=this.rootViewRect.h,m=e.l,y=e.t,f=e.r,p=e.b,v=t.h,g=t.l,w=t.t,x=t.r,b=t.b,I=m-g,C=x-f,k=p-w,S=b-y;switch(i=C>=h?"right":I>=h?"left":C>=I?"right":"left",o=S>=d?"down":k>=d?"up":S>=k?"bottom":"top",s.debug("menu view dock @",i,o),i){case"left":u=m-(l=h);break;case"right":l=h,u=f}switch(o){case"up":c=p-(a=d);break;case"down":a=d,c=y;break;case"top":a=Math.min(d,v),c=w;break;case"bottom":c=b-(a=Math.min(d,v))}return new n(u,c,l,a)},e}(),a=function(){function e(t){e.assgin(this,{layer:document.body,i18n:function(e){return e}}),e.assgin(this,t)}return e.assgin=function(e,t){t&&e&&(e.layer=t.layer||e.layer,e.i18n=t.i18n||e.i18n,t.style&&(e.style?(e.style.contextmenu=t.style.contextmenu||e.style.contextmenu,e.style.contextmenuIn=t.style.contextmenuIn||e.style.contextmenuIn,e.style.contextmenuOut=t.style.contextmenuOut||e.style.contextmenuOut,e.style.contextmenuDivider=t.style.contextmenuDivider||e.style.contextmenuDivider,e.style.contextmenuItem=t.style.contextmenuItem||e.style.contextmenuItem,e.style.contextmenuItemSelected=t.style.contextmenuItemSelected||e.style.contextmenuItemSelected,e.style.contextmenuItemDisabled=t.style.contextmenuItemDisabled||e.style.contextmenuItemDisabled,e.style.contextmenuItemIcon=t.style.contextmenuItemIcon||e.style.contextmenuItemIcon,e.style.contextmenuItemName=t.style.contextmenuItemName||e.style.contextmenuItemName,e.style.contextmenuItemHotkey=t.style.contextmenuItemHotkey||e.style.contextmenuItemHotkey,e.style.contextmenuItemArrow=t.style.contextmenuItemArrow||e.style.contextmenuItemArrow):e.style=t.style))},e}(),h=function(){function i(e,t,n){this.id=(new Date).toUTCString(),this.menuStacks=new u,this.event=e,this.menuItems=t,this.menuPosition=e.getPoint(),this.menuOptions=n||new a}return i.prototype.getMenuItemsById=function(n){var i,o,r,s;if(!n||"0"===n)return this.menuItems;if(0===n.indexOf("0")){var u=n.split(",");u.shift();var c=this.menuItems;try{for(var l=e(u),a=l.next();!a.done;a=l.next()){var h=a.value,d=0;try{for(var m=(r=void 0,e(c)),y=m.next();!y.done;y=m.next()){var f=y.value;if(!t.isDivider(f)&&parseInt(h,10)===d++){var p=null==f?void 0:f.children;if(null==p)return;c=p}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(s=m.return)&&s.call(m)}finally{if(r)throw r.error}}}}catch(e){i={error:e}}finally{try{a&&!a.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return c}},i.prototype.hideMenu=function(e){e||(e="0"),this.hideMenuStack(e)},i.prototype.showMenu=function(t){var n,i;t||(t="0");for(var o=new u,r=t.split(",");r.length>0;){var c=r.join(",");o.set(c,""),r.pop()}var l=o.keys(),a=this.menuStacks.keys();try{for(var h=e(a),d=h.next();!d.done;d=h.next()){var m=d.value;o.has(m)||(s.debug("menu remove by id",m),this.hideMenuStack(m))}}catch(e){n={error:e}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}this.showMenuStack(l)},i.prototype.hideMenuStack=function(e){var t=this;this.menuStacks.forEach((function(n,i){i.indexOf(e)>=0&&(n.hide(),t.menuStacks.delete(i))}))},i.prototype.showMenuStack=function(t){var i,o,u=this;t.sort(),s.debug("menu show stacks :",t);var c=this.menuStacks,a=function(e){var i=e.indexOf(",")>=0,o=parseInt(i?e.substr(e.lastIndexOf(",")+1):e,10),a=i?e.substr(0,e.lastIndexOf(",")):void 0,d=void 0===a?void 0:c.get(a);void 0!==d&&d.select(o);var m=c.get(e);if(void 0!==m)return m.select(-1),"continue";var y=h.getMenuItemsById(e);if(!y)return s.debug("menu show stacks : no items "),{value:void 0};var f=new l(e,y,h.menuOptions);f.onStateChangedListener={onSelected:function(t){-1===t?u.postSelection("o",e):u.postSelection("i",e+","+t)},onClicked:function(e,t){u.onItemClick&&u.onItemClick(e,t)},onRenderStart:function(){},onRenderStop:function(){u.showMenuStack(t)}},f.rootView.oncontextmenu=function(e){r.preventEvent(e)},f.rootView.onmouseenter=function(){u.postSelection("i",e)},f.rootView.onmouseleave=function(){u.postSelection("o","0")};var p=void 0===d?new n(h.menuPosition.x,h.menuPosition.y,0,0):d.itemViewRects.get(o);p&&h.isAlive()&&(s.debug("menu show stack :",e),f.show(p),h.menuStacks.set(e,f))},h=this;try{for(var d=e(t),m=d.next();!m.done;m=d.next()){var y=a(m.value);if("object"==typeof y)return y.value}}catch(e){i={error:e}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}},i.prototype.postSelection=function(e,t){var n=this;"i"===e&&this.postSelectionType===e&&this.postSelectionId.indexOf(t)>=0||(s.debug("menu post stacks : id =",t),clearTimeout(this.postSelectionTimerId),this.postSelectionType=e,this.postSelectionId=t,this.postSelectionTimerId=setTimeout((function(){n.isDestroyed()?s.debug("menu is destroyed"):n.showMenu(t)}),10))},i.prototype.isAlive=function(){return!this.isDestroyed()},i.prototype.isDestroyed=function(){return!0===this.destroyed},i.prototype.postDestroy=function(){var e=this;this.destroyed=!0,clearTimeout(this.postSelectionTimerId),this.hideMenu(),setTimeout((function(){e.menuStacks.size()>0&&e.postDestroy()}),50)},i}(),d=function(){function e(e){this.e=e,this.target=new o((null==e?void 0:e.srcElement)||(null==e?void 0:e.target)),this.button=e.button,this.keyCode=e.keyCode,this.charCode=e.charCode,this.which=e.which,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey}return e.prototype.isKeyboardEvent=function(){return this.e instanceof KeyboardEvent||this.e.keyCode||this.e.charCode||this.e.which},e.prototype.isMouseEvent=function(){return this.e instanceof MouseEvent||this.e.button},e.prototype.getPoint=function(){var e=r.getCurrentScrollLeft(),t=r.getCurrentScrollTop(),n=this.e.clientX||this.e.pageX-e,o=this.e.clientY||this.e.pageY-t;return new i(n,o)},e.prototype.prevent=function(){this.e.preventDefault&&this.e.preventDefault(),this.e.stopPropagation&&this.e.stopPropagation(),this.e.cancelBubble=!0,this.e.returnValue=!1},e}(),m=function(){function t(e){this.listeners=new u,this.menu=e}return t.prototype.stop=function(){this.listeners.forEach((function(e,t){window.removeEventListener(t,e)})),this.listeners.clear()},t.prototype.start=function(t){var n,i,r=this,c=function(t){if(null==t||0===t.trim().length)return s.debug("event not found"),"continue";var n=t.split(":"),i=n[0];n.shift();var c=0===n.length?[]:n,a=function(n){var i,l,a,h;if((n=new d(n)).isMouseEvent()){var m=n.getPoint(),y=(null===(h=null===(a=r.menu)||void 0===a?void 0:a.presenter)||void 0===h?void 0:h.menuStacks)||new u;try{for(var f=(i=void 0,e(y.values())),p=f.next();!p.done;p=f.next()){var v=p.value,g=new o(v.rootView).getBoundingClientRect();if(g&&m.x>=g.l&&m.x<=g.r&&m.y>=g.t&&m.y<=g.b)return}}catch(e){i={error:e}}finally{try{p&&!p.done&&(l=f.return)&&l.call(f)}finally{if(i)throw i.error}}var w=[void 0!==(x=n.button)?""+x:"",n.altKey?"alt":"",n.ctrlKey?"alt":"",n.metaKey?"alt":"",n.shiftKey?"alt":""];if(c.length>0&&!r.containsKey(c,w.join("+")))return;r.onevent(t)}else if(n.isKeyboardEvent()){var x=void 0;void 0!==n.keyCode&&(x=void 0===x?n.keyCode:Math.max(x,n.keyCode)),void 0!==n.charCode&&(x=void 0===x?n.charCode:Math.max(x,n.charCode)),void 0!==n.which&&(x=void 0===x?n.which:Math.max(x,n.which)),16!==x&&17!==x&&18!==x&&224!==x||(x=void 0);w=[void 0!==x?""+x:"",n.altKey?"alt":"",n.ctrlKey?"ctrl":"",n.metaKey?"meta":"",n.shiftKey?"shift":""];r.containsKey(c,w.join("+"))&&r.onevent(t)}else 0===c.length?r.onevent(t):s.error("monitor unsupported event: ",t)};s.debug("monitor add listener: ",t,i,c),window.addEventListener(i,a,!0),l.listeners.set(t,a)},l=this;try{for(var a=e(t),h=a.next();!h.done;h=a.next()){c(h.value)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},t.prototype.equalsKey=function(e,t){var n=function(e){return e=(e=(e=(e=e.replace(/\s+/g,"")).replace(/\++/g,"+")).replace(/^\++/g,"")).replace(/\++$/g,"")};e=n(e),t=n(t);var i=e.split("+"),o=t.split("+");return i.sort(),o.sort(),e=i.join("+"),t=o.join("+"),s.debug("monitor event equals : ",e,t),e===t},t.prototype.containsKey=function(t,n){var i,o;try{for(var r=e(t),s=r.next();!s.done;s=r.next()){var u=s.value;if(this.equalsKey(u,n))return!0}}catch(e){i={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return!1},t}(),y=function(){function e(e){this.menu=e}return e.prototype.stop=function(){this.stopped=!0,this.timer&&(clearTimeout(this.timer),this.timer=void 0)},e.prototype.start=function(){this.stop(),this.stopped=!1,this.run()},e.prototype.run=function(){var e=this;this.timer=setTimeout((function(){var t,n,i;if(!0!==e.stopped){var o=null===(n=null===(t=e.menu)||void 0===t?void 0:t.presenter)||void 0===n?void 0:n.event,r=null===(i=null==o?void 0:o.target)||void 0===i?void 0:i.getBoundingClientRect();r&&(void 0===e.targetRect||r.equals(e.targetRect)?e.targetRect=r:e.hide()),e.run()}}),100)},e.prototype.hide=function(){this.targetRect=void 0,this.onchanged&&this.onchanged("other:target moved or resize")},e}(),f=function(){function e(e){this.targetRectListner=new y(e),this.eventsListener=new m(e),this.events=["keydown:27","mousedown","resize"],this.menu=e}return e.prototype.start=function(){var e=this;s.debug("monitor start");var t=function(t){e.menu.presenter&&(s.debug("monitor hidemenu by ",t),e.menu.hide())};this.targetRectListner.onchanged=t,this.targetRectListner.start(),this.eventsListener.onevent=t,this.eventsListener.start(this.events)},e.prototype.stop=function(){this.targetRectListner.stop(),this.eventsListener.stop(),s.debug("monitor stop")},e}(),p=new(function(){function e(){this.options=new a,this.options=new a}return e.prototype.config=function(e){a.assgin(this.options,e)},e.prototype.hide=function(){this.monitor&&this.monitor.stop(),null!=this.presenter&&(s.debug("hide menu"),this.presenter.postDestroy(),this.presenter=void 0)},e.prototype.show=function(e,n){var i=this,o=new d(window.event);if(o.isMouseEvent()){o.prevent(),this.hide(),s.debug("show menu",e,o.getPoint());var r=new a;a.assgin(r,this.options),a.assgin(r,n),this.presenter=new h(o,e,r),this.presenter.onItemClick=function(e,n){t.isEnabled(n)&&n.onclick&&(i.hide(),setTimeout((function(){t.isEnabled(n)&&n.onclick&&n.onclick(e,n)}),10))},this.presenter.showMenu(),this.monitor=new f(this),this.monitor.start()}},e}());window&&Object.defineProperty(window,"ContextMenu",{value:p,writable:!1,configurable:!1}),Object.defineProperty(p,"debug",{value:function(e){s.debuggable=e},writable:!1,configurable:!1});export default p;export{p as ContextMenu,a as ContextMenuOptions};
//# sourceMappingURL=contextmenu.esm.js.map
